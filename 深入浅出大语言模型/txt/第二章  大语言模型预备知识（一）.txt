第二章 大语言模型预备知识（一）

2.1 矩阵

m行n列矩阵或m×n矩阵

简记为

当m=n时矩阵A称为n阶方阵

? = ?

?

1

2

1

1

?12

?22 ⋯

⋯

?1?

?2?

⋮ ⋮ ⋱ ⋮

??1 ??2 ⋯ ???

 

? = ??? ??

? = ???

1，矩阵的加减法

两个同为m行n列的矩阵可以相加或相减，结果还是m行n列矩阵

设? = (???)??、? = (???)??

其中??? = ??? ± ???

? = ? ± ? = ?

?

1

2

1

1

?12

?22 ⋯

⋯

?1?

?2?

⋮ ⋮ ⋱ ⋮

??1 ??2 ⋯ ???

 

2，数值与矩阵的乘除法

设数值k、矩阵? = (???)??，则k乘以A：

数与矩阵的乘法满足交换律：

? ∙ ? = ?

?

?

?

1

2

1

1

??12

??22 ⋯

⋯

?

?

?

?

1

2

?

?

⋮ ⋮ ⋱ ⋮

???1 ???2 ⋯ ????

 

? ∙ ? = ? ∙ ?

2，数值与矩阵的乘除法

数值k、矩阵? = (???)??，则A除以k：

?

?

=

 

 

 

 

 

 

 

?11

?

?

?

21

?12

?

?

?

22 ⋯

⋯

?1?

?

⋮ ⋮ ⋱

?

?

2

⋮

?

??

?

1 ??

?

2 ⋯

??

?

?

 

 

 

 

 

 

 

3，矩阵乘法

当矩阵A的列数等于矩阵B的行数时，矩阵A与B可以相乘

设矩阵? = (???)??、? = (???)??，则：

结果C为m行n列矩阵

? = ? ∙ ? = ?

?

1

2

1

1

?12

?22 ⋯

⋯

?1?

?2?

⋮ ⋮ ⋱ ⋮

??1 ??2 ⋯ ???

 

3，矩阵乘法

??? = ??1?1? + ??2?2? + … + ?????? = 

ℎ=1

?

??ℎ?ℎ?

 

 

 

 

 

?11

⋮

?

?

?

⋮

?1

1 …

⋮…

…

⋮

?

⋮

1?

?

?

?

⋮

??

? …

⋮…

…

⋮

?1

⋮

?

?

?

?

⋮

??

?

 

 

 

 

 

 

 

 

 

 

?1

⋮

1

?

?

?

⋮

?1

1 …

⋮…

…

⋮

?

⋮

1?

?

?

⋮

?

??

? …

⋮…

…

⋮

?1

⋮

?

?

?

?

⋮

??

?

 

 

 

? = ? ∙ ? = ∙ 

 

=

 

 

 

 

 

?11

⋮

?

?

?

⋮

?1

1 …

⋮…

…

⋮

?1

⋮

?

?

?

?

⋮

??

? …

⋮…

…

⋮

?1

⋮

?

?

?

?

⋮

??

?

 

 

 

 

 

矩阵乘法的性质

不满足交换律

满足结合律

满足分配律

?

?

∙

∙?

?

≠

∙ ?

?

=

∙ ?

(? ∙ ?) ∙ ? = ? ∙ (? ∙ ?)

(?

?

+

∙ (

?

?

) ∙+

?

?

=

) =

? ∙?

?

∙ +

? +

? ∙?

?

∙ ?

4，矩阵的转置

转置：矩阵所有的行按顺序变换成列

矩阵A的转置用?

?表示

设矩阵? = (???)??，则? = ?

?为：

? = ?

? = (???)??

其中??? = ???、

例：

 1

2

3

4

1

1

1

1

1

2

3

4

2

2

2

2

1

2

3

4

3

3

3

3

1

2

3

4

4

4

4

4

 T

= 1

1

1

1

1

2

3

4

2

2

2

2

1

2

3

4

3

3

3

3

1

2

3

4

4

4

4

4

1

2

3

4

 

转

(

置

? ±

的

?

性

)

质

? = ?

? ± ?

?

(? ⋅ ?)? = ?

?

⋅ ?

?

(?

?

)?

(??)

= ?

? = ??

?

，其中k为标量

2.2 向量

向量是矩阵的特殊形式

q 只有一行或者一列

行向量

列向量

如果没有特殊说明，我们默认向量为行向量

? = (?1, ?2, …, ??

)

? = ?

?

?

⋮

?

1

2

 = (?1, ?2, …, ??

)?

= ?

?

?

⋮

?

1

2

 ?

1，向量的几何含义

有向线段

大小和方向

2，向量的加减法

设? = (?1, ?2, …, ??

)

? = (?1, ?2, …, ??

)

则：

? = ? ± ? = (?1, ?2, …, ??

)

其中?? = ?? ± ??

2，向量的加减法

向量加法的几何含义

? = ? + ?

2，向量的加减法

向量减法的几何含义

? = ? − ?

= ? + (−?)

数值与向量的乘除法

数值k乘以向量a

向量除以数值k

几何含义

q 对向量的伸缩

q 当k>0时方向与原向量一致

q 当k<0时方向与原向量相反

? ∙ ? = (??1, ??2, …, ???

)

?

?

= ?

?

1

,

?

?

2

, …,

?

?

? 

3，向量的乘法

常用的向量乘法是向量的点积运算又称内积

点积：行向量乘以列向量，结果为标量

点积记为? ⋅ ?

?或者??

?

在没有混淆的情况下，也简记为? ⋅ ?或者??

设? = (?1, ?2, …, ??

)

? = (?1, ?2, …, ??)

则：

? ⋅ ?

? = (?1, ?2, …, ??

) ∙ (?1, ?2, …, ??

)? = ?

?

=1 ????

点积的几何含义

由余弦定理：

其中 ? 表示向量a的长度称作a的模

点积反应了两个向量的相似程度

余弦相似度

q 归一化的点积

? ⋅ ?

? = ? ? cos (?)

 ? = ?1

2 + ?2

2 + … + ??

2

 ?

?

 

⋅ ?

?

 ? 

=

? ⋅ ?

?

 ? ? 

=cos (?)

4，矩阵与向量的乘法

设矩阵? = (???)??、行向量? = (?1, ?2, …, ??)

行向量右乘矩阵：

q 矩阵的行数与向量的元素数相等

q 结果为行向量，其元素数等于矩阵的列数

用???表示A的第i列组成的列向量：

? ∙ ?

??? = (?1?

, ?2?

, …, ???)?

? ∙ ? = ? ∙ ?1?

, ?2?

, …, ??

? 

= ? ∙ ?1?

, ? ∙ ?2?

, …, ? ∙ ??

? 

= 

?=

?

1

????1 , 

?=

?

1

????2 , …, 

?=

?

1

????? 

4，矩阵与向量的乘法

设矩阵? = (???)??、列向量? = (?1, ?2, …, ??)?

矩阵左乘列向量：

q 矩阵的列数与向量的元素数相等

q 结果为列向量，其元素数等于矩阵的行数

用??表示A的第i行组成的行向量：

? ∙ ?

?? = (??1, ??2, …, ???

)

? ∙ ?

? = ?1, ?2, …, ?? ?

∙ ?

?

= ?1 ∙ ?

?

, ?2 ∙ ?

?

, …, ?? ∙ ?

? 

= 

?=

?

1

?1???

, 

?=

?

1

?2???

, …, 

?=

?

1

????? ?

矩阵右乘向量的几何意义

从相似性角度

得到反映相似度的行向量

q 第i个元素为x与A的第i列的相似性

? ∙ ? = ? ∙ ?1?

, ?2?

, …, ??

? 

= ? ∙ ?1?

, ? ∙ ?2?

, …, ? ∙ ??

? 

矩阵右乘向量的几何意义

从空间变换角度

q 对向量的旋转

x

y

o

? = ? ∙ ?

?

?

x’

矩阵右乘向量的几何意义

从空间变换角度

q 对坐标的旋转

x

y

o

? = ? ∙ ?

?

?

x’

y’

?


